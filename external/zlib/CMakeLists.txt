if(WIN32)
    set(ZLIB_STATIC_LIBRARY_NAME zlibstatic)
else()
    set(ZLIB_STATIC_LIBRARY_NAME z)
endif()
include(ExternalProject)
ExternalProject_Add(zlib
    URL "https://zlib.net/zlib-1.2.11.tar.gz"
    URL_HASH SHA256=c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1

    SOURCE_DIR "${CMAKE_CURRENT_BINARY_DIR}/zlib-src"
    BINARY_DIR "${CMAKE_CURRENT_BINARY_DIR}/zlib-build"
    INSTALL_COMMAND ""
    CMAKE_ARGS "-DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_SHARED_LIBS=OFF"
    CMAKE_CACHE_ARGS "-DCMAKE_C_FLAGS:STRING=${CMAKE_C_FLAGS}"

    UPDATE_COMMAND ""
    ALWAYS 0

    BUILD_BYPRODUCTS "<BINARY_DIR>/${CMAKE_STATIC_LIBRARY_PREFIX}${ZLIB_STATIC_LIBRARY_NAME}${CMAKE_STATIC_LIBRARY_SUFFIX}"
    )
ExternalProject_Get_Property(zlib SOURCE_DIR)
ExternalProject_Get_Property(zlib BINARY_DIR)
set(ZLIB_STATIC_LIBRARY ${BINARY_DIR}/${CMAKE_STATIC_LIBRARY_PREFIX}${ZLIB_STATIC_LIBRARY_NAME}${CMAKE_STATIC_LIBRARY_SUFFIX})
set(ZLIB_LIBRARIES ${ZLIB_STATIC_LIBRARY} PARENT_SCOPE)
set(ZLIB_INCLUDE_DIRS ${SOURCE_DIR} ${BINARY_DIR} PARENT_SCOPE)
