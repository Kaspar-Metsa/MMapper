include(ExternalProject)
ExternalProject_Add(zlib
    URL "https://github.com/madler/zlib/archive/v1.2.11.zip"
    URL_HASH SHA1=eba1cd6f2e3c7a75fe33a8b02b4d7e4b1ad58481

    SOURCE_DIR "${CMAKE_CURRENT_BINARY_DIR}/zlib-src"
    BINARY_DIR "${CMAKE_CURRENT_BINARY_DIR}/zlib-build"
    INSTALL_COMMAND ""
    CMAKE_ARGS "-DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_SHARED_LIBS=OFF"
    CMAKE_CACHE_ARGS "-DCMAKE_C_FLAGS:STRING=${CMAKE_C_FLAGS}"

    UPDATE_COMMAND ""
    ALWAYS 0
    )
if(WIN32)
    set(ZLIB_STATIC_LIBRARY_NAME zlibstatic)
else()
    set(ZLIB_STATIC_LIBRARY_NAME z)
endif()
set(ZLIB_STATIC_LIBRARY ${CMAKE_CURRENT_BINARY_DIR}/zlib-build/${CMAKE_STATIC_LIBRARY_PREFIX}${ZLIB_STATIC_LIBRARY_NAME}${CMAKE_STATIC_LIBRARY_SUFFIX})
set(ZLIB_LIBRARIES ${ZLIB_STATIC_LIBRARY} PARENT_SCOPE)
set(ZLIB_INCLUDE_DIRS
    ${CMAKE_CURRENT_BINARY_DIR}/zlib-src
    ${CMAKE_CURRENT_BINARY_DIR}/zlib-build
    PARENT_SCOPE)
